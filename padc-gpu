#!/bin/bash
# Wrapper script to run paDC with GPU support

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Set up the library path for cuDNN
export LD_LIBRARY_PATH="$SCRIPT_DIR/.venv/lib/python3.12/site-packages/nvidia/cudnn/lib:$LD_LIBRARY_PATH"

# Run paDC with GPU adapter as default
if [[ "$*" == *"-a"* ]] || [[ "$*" == *"--adapter"* ]]; then
    # If adapter is already specified, just pass through
    uv run --project "$SCRIPT_DIR" padc "$@"
else
    # Default to GPU adapter if not specified
    uv run --project "$SCRIPT_DIR" padc "$@" -a local_gpu
fi